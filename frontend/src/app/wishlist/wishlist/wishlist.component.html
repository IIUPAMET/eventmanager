<div>
  <button *ngIf="!isIncluded" class="btn btn-outline-info" [routerLink]="['/wishlist/edit']">Edit wish list</button>
  <button *ngIf="!isIncluded" type="button" class="btn btn-secondary" [disabled]="!hasChanges" (click)="update()">
    Save changes
  </button>
  <button *ngIf="isIncluded" type="button" class="btn btn-outline-primary" (click)="updateWishList()">
    Save changes
  </button>

<table class="table table-hover">
  <thead>
  <tr>
    <th scope="col" (click)="sortItems('name')">Name</th>
    <th scope="col" (click)="sortItems('booker_customer_login')" class="text-center">Booker</th>
    <th scope="col" (click)="sortItems('dueDate')" class="text-center">Due date</th>
    <th scope="col" (click)="sortItems('priority')" class="text-center">Priority</th>
    <th scope="col" *ngIf="isIncluded"></th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let itemDto of wishList.items | sortingItems:path:order; let i = index;">
    <td data-toggle="modal" [attr.data-target]="'#modal'+i" class="tdName">{{itemDto.item.name}}</td>
    <td class="text-center">{{itemDto.booker_customer_login}}</td>
    <td *ngIf="itemDto.item.dueDate" class="text-center">{{itemDto.item.dueDate}}</td>
    <td class="text-center">
    <div class="select-style"
         [style.background-color]="
                    itemDto.priority === 1 ? '#d14242':
                    itemDto.priority === 2 ? 'green':'gray'">
      <select *ngIf="isBooker(itemDto.booker_customer_login)" (change)="hasChanges = true">
        <option value="1" (click)="itemDto.priority = 1">High</option>
        <option value="2" (click)="itemDto.priority = 2">Avg</option>
        <option value="3" (click)="itemDto.priority = 3">Low</option>
      </select>
    </div>
    </td>
    <td *ngIf="isIncluded" class="text-center">
    <button (click)="removeItem(itemDto)" class="btn-sm button btn-outline-danger">Remove</button>
    </td>
  </tr>
  </tbody>
</table>


<div *ngFor="let itemDto of wishList.items; let i = index;"
     class="modal fade"
     id="modal{{i}}"
     tabindex="-1" role="dialog"
     aria-labelledby="exampleModalCenterTitle" aria-hidden="true">

  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalCenterTitle">{{itemDto.item.name}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="card">
          <img *ngIf="!itemDto.item.image" class="card-img-top" src="../../../assets/img/default_image.png" alt="Card image">
          <img *ngIf="itemDto.item.image" class="card-img-top" [attr.src]="itemDto.item.image" alt="Card image">
          <div class="card-body">
            <h6 class="card-subtitle mb-2 text-muted">{{itemDto.item.dueDate}}</h6>
            <p class="card-text">{{itemDto.item.description}}</p>
            <a *ngIf="itemDto.item.link"
               href="{{itemDto.item.link}}"
               class="card-link">link</a>
          </div>

          <div class="card-footer container">
            <div class="row">
              <div class="col-8">
                <small *ngIf="itemDto.booker_customer_login"
                       class="text-muted">
                    Booker: {{itemDto.booker_customer_login}}
                </small>
                <small *ngIf="!itemDto.booker_customer_login">Booker: none</small>
              </div>
              <div class="col">
                <small *ngIf="isBooker(itemDto.booker_customer_login)">
                  <label for="selectPriority">Priority:</label>
                  <select (change)="hasChanges = true" id="selectPriority">
                    <option value="1" (click)="itemDto.priority = 1">High</option>
                    <option value="2" (click)="itemDto.priority = 2">Avg</option>
                    <option value="3" (click)="itemDto.priority = 3">Low</option>
                  </select>
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button href="#" class="btn btn-primary"
                *ngIf="!itemDto.booker_customer_login"
                (click)="bookItem(itemDto)">Book It
        </button>
      </div>
    </div>
  </div>
</div>

</div>
